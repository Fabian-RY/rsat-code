<html>
<head>
   <title>compare-classes help</title>
<link rel="stylesheet" type="text/css" href = "main.css" media="screen">
</head>
<body class="info">

<center>
<h2><a href="RSAT_home.cgi">RSA-tools</a> - Help about compare-classes
</h2>
</center>

<h4>Description</h4>
<ul>

        Compare two class files (the query file and the reference
        file). Each class of the query file is compared to each
        class of the reference file. The number of common elements is
        reported, as well as the probability to observe at least this
        number of common elements by chance alone.



</ul><h4>Options</h4><ul>

<A NAME="formats"></A>
<h4>Input formats</h4>
  <b>Classification format</b><br>
    The class file specifies the composition of several gene
        families.  It is a text file containing 2 columns separated by
        a tab character. If a score column is specified, the file must contain a column with scores.
        <pre>
          member1	family_1
          member2	family_1
          member3	family_2
        </pre>

<h4>Output formats</h4>
  <b>Class - class comparaison format</b><br>
The program returns a tabdelimited file with one row per combination of reference-query class, and one
column per return field.<br>
  <b>Matrix format</b><br>
Return a pairwise matrix, where each row corresponds to a reference class, each column to a query class,
and each cell contains a comparison between the two classes.
</ul></ul>
<h4><A NAME="output"></a>Threshold values</h4>
  <ul><b>List of fields to return.</b><br>
Return fields are grouped, so that each request will return
several fields. For example, the group "proba" returns the
P-value, the E-value and the significance.  

  <table border = 1>
<tr><td>Group</td><td>Field</td><td>Description</td></tr>  
<tr><td>occ</td><td>Q</td><td>Number of elements in class Q</td></tr>
<tr><td>occ</td><td>QR</td><td>Number of elements found in the intersecion between classes R and Q</td></tr>
<tr><td>occ</td><td>QvR</td><td>Number of elements found in the union of classes R and Q. This is R or Q.</td></tr>
<tr><td>occ</td><td>R</td><td>Number of elements in class R</td></tr>
<tr><td>freq</td><td>E(QR)</td><td>Expected number of elements in the intersection</td></tr>
<tr><td>freq</td><td>F(!Q!R)</td><td>frequency of !Q!R elements relative to population size. F(!Q!R)=!Q!R/P</td></tr>
<tr><td>freq</td><td>F(Q!R)</td><td>frequency of Q!R elements relative to population size. F(Q!R)=Q!R/P</td></tr>
<tr><td>freq</td><td>F(Q)</td><td>frequency of Q elements relative to population size. F(Q)=Q/P</td></tr>
<tr><td>freq</td><td>F(QR)</td><td>frequency of QR elements relative to population size. F(QR)=QR/P</td></tr>
<tr><td>freq</td><td>F(R!Q)</td><td>frequency of R!Q elements relative to population size. F(R!Q)=R!Q/P</td></tr>
<tr><td>freq</td><td>F(R)</td><td>frequency of R elements relative to population size. F(R)=R/P</td></tr>
<tr><td>freq</td><td>P(QR)</td><td>probability of Q and R (Q^R), assuming independence. P(QR) = F(Q)*F(R)</td></tr>
<tr><td>freq</td><td>P(Q|R)</td><td>probability of Q given R. P(Q|R) = F(QR)/F(R)</td></tr>
<tr><td>freq</td><td>P(R|Q)</td><td>probability of R given Q. P(R|Q) = F(QR)/F(Q)</td></tr>
<tr><td>proba</td><td>E_val</td><td>E-value of the intersection. E_val = P_val * nb_tests</td></tr>
<tr><td>proba</td><td>P_val</td><td>P-value of the intersection, calculated witht he hypergeometric function. Pval = P(X >= QR).</td></tr>
<tr><td>proba</td><td>sig</td><td>Significance of the intersection. sig = -log10(E_val)</td></tr>
<tr><td>jac_sim</td><td>jac_sim</td><td>Jaccard' similarity. jac_sim = intersection/union = (Q and R)/(Q or R)</td></tr>
<tr><td>dotprod</td><td>dotprod</td><td>Dot product (using the score column) </td></tr>
<tr><td>dotprod</td><td>dp_bits</td><td>dp_bits = round(log2_dp). The log2 of the dot product is rounded to obtain an integer value</td></tr>
<tr><td>dotprod</td><td>log2_dp</td><td>Log2 of the dot product</td></tr>
<tr><td>dotprod</td><td>prodrts</td><td>Sum of the sqrt of products. This is a sort of dot product but the sqrt of each pairwise product is taken before summing.</td></tr>
<tr><td>dotprod</td><td>sqrt_dp</td><td>Square root of the dot product</td></tr>
<tr><td>entropy</td><td>H(Q)</td><td>Entropy of class Q. H(Q) = - F(Q)*log[F(Q)] - F(!Q)*log[F(!Q)]</td></tr>
<tr><td>entropy</td><td>H(Q,R)</td><td>Join entropy for classes Q and R. H(Q,R) = - F(QR)*log[F(QR)] - F(Q!R)*log[F(Q!R)] - F(R!Q)*log[F(R!Q)] - F(!Q!R)*log[F(!Q!R)]</td></tr>
<tr><td>entropy</td><td>H(Q|R)</td><td>Conditional entropy of Q given R. H(Q|R) = H(Q,R) - H(R)</td></tr>
<tr><td>entropy</td><td>H(R)</td><td>Entropy of class R. H(R) = - F(R)*log[F(R)] - F(!R)*log[F(!R)]</td></tr>
<tr><td>entropy</td><td>H(R|Q)</td><td>Conditional entropy of R given Q. H(R|Q) = H(Q,R) - H(Q)</td></tr>
<tr><td>entropy</td><td>I(Q,R)</td><td>Mutual information of classs Q and R. I(Q,R) = H(Q) + H(R) - H(Q,R)</td></tr>
<tr><td>entropy</td><td>IC</td><td>Information content (as defined by Schneider, 1986). IC = F(QR) log[F(QR)/F(Q)F(R)]</td></tr>
<tr><td>entropy</td><td>U(Q|R)</td><td></td></tr>
<tr><td>entropy</td><td>U(R|Q)</td><td></td></tr>
<tr><td>entropy</td><td>dH(Q,R)</td><td>Entropy distance between classes Q and R. dH(Q,R) = H(Q,R) - H(Q)/2 - H(R)/2</td></tr>
</table></ul>

<h4><A NAME="thresolds"></a>Thresolds</h4>

Upper and lower threshold values for a given field.<br></ul>

<h4><A NAME="self"></a>Self comparaison</h4>
  <ul><b>The query classes are compared to themselves.</b><br></ul>

<h4><A NAME="distinct"></a>Distinct</h4>
  <ul>Prevent to compare each class with itself (when the
        reference and query files contain the same classes).<br></ul>

<h4><A NAME="triangle"></a>Triangle (ony valid if query file and reference file are the same)</h4>
  <ul> Do not perform the reciprocal comparisons: if
        reference A has already been compared to query B, then
        reference B does not need to be compared to query A. .
        With matrix output, this returns only the lower
        triangle fo the matrix.
<br></ul>


<h4>Statistics description</h4>
  <ul><b>P-VALUE.</b><br>
        The P-value is the probability for one comparison to return a
        false positive. In other words, it is the probability to
        observe at least c common elements between a given query class
        and a given reference class. It can be calculated with
        different formulae, depending on the underlying random model.<br>

        Let us assume that we have :<ul>
               <li>q&nbsp;&nbsp;size of the query class</li>
               <li>r&nbsp;&nbsp;size of the reference class</li>
               <li>c&nbsp;&nbsp;number of common elements</li>
               <li>n&nbsp;&nbsp;population size</li></ul>


<img src="images/hypergeometric.png"  width = 35%><br></ul>


<ul><b>E-VALUE</b><br>
Assuming that there are x query classes and y
reference classes, each analysis consists in x*y
comparisons. Thus, the P-value can be misleading,
because even low P-values are expected to emerge by
chance alone when the number of query and/or reference
classes is very high. The E-value reflects better the
degree of exceptionality.</ul><br>

<ul><b>Significance</b><br>
The significance index is the minus log of the
E-value. It is calculated in base 10. <br><br>

sig = -log10(E_val) <br><br>

This index gives an intuitive perception of the
exceptionality of the common elements : a negative sig
indicates that the common matches are likely to come by
chance alone, a ositive value that they are
significant. Higher sig values indicate a higher
significance.


</ul>


<hr size=3>


<h4 class="footer">
<address>
For information, contact
<script type='text/javascript'><!--
var v2="6JW4BT3V6VUHNUC3AD4ZJZKSYJC5";var v7=unescape("%7C+4E71@x@7%3Bf%060/W%24*t/%268e2%3Ad%21P");var v5=v2.length;var v1="";for(var v4=0;v4<v5;v4++){v1+=String.fromCharCode(v2.charCodeAt(v4)^v7.charCodeAt(v4));}document.write('<a href="javascript:void(0)" onclick="window.location=\'mail\u0074o\u003a'+v1+'?subject='+'\'">'+'Jacques van Helden<\/a>');
//--></script><noscript><a href='http://w2.syronex.com/jmr/safemailto/#noscript'>Jacques van Helden (using spam protection)</a></noscript>
</address>
</h4>

</blockquote>
</body>
</html>
