<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<html>
<head>
   <title>RSA-tools: convert-matrix manual</title>
<link rel="stylesheet" type="text/css" href = "main.css" media="screen">
</head>
<body class="info">


<center>
<h2><a href="RSA_home.cgi">RSA-tools</A> - <a href=convert-matrix_form.cgi>convert-matrix</a> manual</h2>
</center>

<H4>Name</H4><UL>

convert-matrix

<p>
2004 by <script type='text/javascript'><!--
var v2="6JW4BT3V6VUHNUC3AD4ZJZKSYJC5";var v7=unescape("%7C+4E71@x@7%3Bf%060/W%24*t/%268e2%3Ad%21P");var v5=v2.length;var v1="";for(var v4=0;v4<v5;v4++){v1+=String.fromCharCode(v2.charCodeAt(v4)^v7.charCodeAt(v4));}document.write('<a href="javascript:void(0)" onclick="window.location=\'mail\u0074o\u003a'+v1+'?subject='+'\'">'+'Jacques van Helden<\/a>');
//--></script><noscript><a href='http://w2.syronex.com/jmr/safemailto/#noscript'>Jacques van Helden (using spam protection)</a></noscript>


</ul><h4>Description</h4><ul>

<p> Performs inter-conversions between various formats of
position-specific scoring matrices (PSSM).</p>

<p> The program also performs a statistical analysis of the original
matrix to provide different position-specific scores (weight,
frequencies, information contents), general statistics (E-value, total
information content), and synthetic descriptions (consensus).</p>

<p>PSSM can be used to represent the binding specificity of a transcription
factor or the conserved residues of a protein domain.</p>

<p>Each row of the matrix corresponds to one residue (nucleotide or
amino-acid depending on the sequence type).  Each column corresponds
to one position in the alignment.  The value within each cell
represents the frequency of each residue at each position.</p>


</ul><h4><a name="io_format"></a>INPUT/OUTPUT FORMATS</h4>
<p>
Some formats are supported only for input, others for output. There
are more formats accepted for input, because the general use of this
program is to convert a PSSM obtained from a database (e.g. TRANSFAC)
or a pattern-discovery program (e.g. consensus, gibbs, meme,
MotifSampler, ...) and obtain a matrix either for scanning (with
matrix-scan) or for computing statistical parameters (see the return
fields below).</p>
    
<p>
  <ul>
  <li> <strong> tab (input/output)</strong> </li> tab-delimited
    file. One row per residue, one column per position. The first
    column of each row indicates the residue, the following columns
    give the frequency of that residue at the corresponding position
    of the matrix.</li>

<p>
  The tab format accepts a user-specific set of return fields (option
  -return), proviging different statistics on the matrix (counts,
  frequencies, weights, information, other parameters: see description
  below).
<pre>     
; MET4 matrix, from Gonze et al. (2005). Bioinformatics 21, 3490-500.
A |   7   9   0   0  16   0   1   0   0  11   6   9   6   1   8
C |   5   1   4  16   0  15   0   0   0   3   5   5   0   2   0
G |   4   4   1   0   0   0  15   0  16   0   3   0   0   2   0
T |   0   2  11   0   0   1   0  16   0   2   2   2  10  11   8
//
</pre>
        
 <li> <strong> 
    patser (output)</strong> </li>
        This format can be used as input to scan sequences with
        patser, the pattern-matching program developed by Jerry Hertz.
<p>
        This is actually the same format as tab (described above), but
        the only return field is the count matrix.

  <li> <strong>    assembly (input)</strong> </li>
	Output file from the program pattern-assembly. One assembly
	file can contain zero, one or several assemblies. Each
	assembly is converted to a position-specific scoring matrix by
	taking, for each residue at each position, the score of the
	most significant pattern (oligonucleotide) containing that
	residue in this position of the assembly.

 <li> <strong>     consensus (input/output)</strong> </li>
	Output file from consensus, the pattern-discovery program
	developed by Jerry Hertz (Hertz et al., Comput Appl Biosci,
	1990:6, 81-92). This file contains one or several matrices, +
	additional information on the parameters used for pattern
	discovery (e.g. prior residue frequencies).

  <li> <strong>    gibbs (input)</strong> </li>
	Output file from gibbs, the pattern-discovery program
	developed by Andrew Neuwald (Lawrence et al. Science, 1993:
	262, 208-214; Neuwald, et al. Protein Sci, 1995: 4, 1618-1632)

  <li> <strong>    meme (input)</strong> </li>
	Output file from MEME, the pattern-discovery program developed by
	tim Bailey.This file contains one or several matrices, +
	additional information on the parameters used for pattern
	discovery (e.g. prior residue frequencies).

  <li> <strong>    MotifSampler (input/output)</strong> </li>
	Output file from MotifSampler, the pattern-discovery program
	developed by Gert Thijs (Thijs et al. Bioinformatics, 2001:17,
	1113-1122).

  <li> <strong>    TRANSFAC (input/output)</strong> </li>
        Format used in the TRANSFAC database;
        (<a href='http://www.gene-regulation.com/pub/databases.html'>http://www.gene-regulation.com/pub/databases.html</a>)


  <li> <strong>    cb (input)</strong> </li>
	Cluster-Buster output file (usual extention .cb). The header
	line starts with a > (like in fasta format). The matrix is
	then printed "vertically" on the following lines: each column
	corresponds to one residue, and each row to a position in the
	alignment.

   <li> <strong>   feature (input)</strong> </li>
        Output file from convert-features. 

        This format allows to obtain a PSSM from a list of (supposedly
        pre-aligned) sites. These sites can themselves have been
        collected by scanning sequences with a matrix (matrix-scan) or
        by searching string-based patterns in a sequence
        (dna-pattern). 

        Converting features to matrices can for example be useful for
        iterative refinment of a matrix (colecting sites from a
        matrix, and building a matrix from those sites).

        Another application is to detect oligomers or dyads in a
        sequence set, and build a matrix from these.

  <li> <strong>    clustal (input)</strong> </li>
	The popular multiple alignemnt program clustalw. 
    
    
    
  </ul>  
    
    

</ul><h4>RETURN FIELDS FOR THE TAB-DELIMITED OUTPUT FORMAT</h4><ul>
<dl>
<dt><strong><a name="item_alignment"></a>counts</strong><br />
</dt>
<dd>
Each cell of the matrix indicates the number of occurrences of the
residue at a given position of the alignment.
</dd>

<p></p>
<dt><strong><a name="item_profile"></a>profile</strong><br />
</dt>
<dd>
The matrix is printed vertically (each matrix column becomes a row in
the output text). Additional parameters (consensus, information) are
indicated besides each position, and a histogram is drawed.
</dd>

<p></p>
<dt><strong><a name="item_crude_frequencies"></a>crude frequencies</strong><br />
</dt>
<dd>
Relative frequencies are calculated as the counts of residues divided
by the total count of the column.
</dd>
<dd>

<p>Fij=Cij/SUMi(Cij)</p>
</dd>
<dd>

<p>where</p>
</dd>
<dl>
<dt><strong><a name="item_cij"></a>Cij</strong><br />
</dt>
<dd>
is the absolute frequency (counts) of residue i at position j of the alignment
</dd>

<p></p>
<dt><strong><a name="item_fij"></a>Fij</strong><br />
</dt>
<dd>
is the relative frequency of residue i at position j of the alignment
</dd>

<p></p></dl>
<dt><strong><a name="item_frequencies_corrected_with_pseudo_2dweights"></a>frequencies corrected with pseudo-weights</strong><br />
</dt>
<dd>
Relative frequencies can be corrected by a pseudo-weight (b) to reduce
the bias due to the small number of observations.
</dd>
<dd>

<p>F''ij=Cij+b*Pi/[SUMi(Cij)+b]</p>
</dd>
<dd>

<p>where</p>
</dd>
<dl>
<dt><strong><a name="item_pi"></a>Pi</strong><br />
</dt>
<dd>
is the prior frequency for residue i
</dd>

<p></p>
<dt><strong><a name="item_b"></a>b</strong><br />
</dt>
<dd>
is the pseudo-weight, which is ``shared'' between residues according to
their prior frequencies.
</dd>

<p></p></dl>
<dt><strong><a name="item_weights"></a>weights</strong><br />
</dt>
<dd>
Weights are calculated according to the formula from Hertz (1999), as
the natural logarithm of the ratio between the relative frequency
(corrected for pseudo-weights) and the prior residue probability.
</dd>
<dd>

<p>Wij=ln(F''ij/Pi)</p>
</dd>

<p></p>
<dt><strong><a name="item_information"></a>information</strong><br />
</dt>
<dd>
The crude information content is calculated according to the formula
from Hertz (1999).
</dd>
<dd>

<p>Iij&nbsp;=&nbsp;Fij*ln(Fij/Pi)</p>
</dd>
<dd>

<p>In addition, we calculate a ``corrected'' information content which
takes pseudo-weights into account.</p>
</dd>
<dd>

<p>I''ij&nbsp;=&nbsp;F''ij*ln(F''ij/Pi)</p>
</dd>

<p></p>
<dt><strong><a name="item_p_2dvalue"></a>P-value</strong><br />
</dt>
<dd>
The P-value indicates the probability to observe at least Cij
occurrences of a residue at a given position of the matrix. It is
calculated with the binomial formula:
</dd>
<dd>
<pre>
    k=C.j    C.j!      k      Cij-k
Pij= SUM  ---------- Pi (1-Pi)
    k=Cij k!(C.j-k)!</pre>
</dd>
<dd>

<p>where</p>
</dd>
<dl>
<dt><strong>Cij</strong><br />
</dt>
<dd>
is the number of occurrences of residue i at position j of
the matrix.
</dd>

<p></p>
<dt><strong><a name="item_c_2ej"></a>C.j</strong><br />
</dt>
<dd>
is the sum of all residue occurrences at position j of the
matrix.
</dd>

<p></p>
<dt><strong>Pi</strong><br />
</dt>
<dd>
is the prior probability of residue i.
</dd>

<p></p></dl>
<dt><strong><a name="item_parameters"></a>parameters</strong><br />
</dt>
<dd>
Returns a series of parameters associated to the matrix. The list of
parameters to be exported depends on the input formats (each pattern
discovery program returns specific parameters, which are more or less
related to each others but not identical).
</dd>
<dd>

<p>Some additional parameters are optionally calculated</p>
</dd>
<dl>
<dt><strong><a name="item_consensus"></a>consensus</strong><br />
</dt>
<dd>
The degenerate consensus is calculated by collecting, at each
position, the list of residues with a positive weight. Contrarily to
most applications, this consensus is thus weighted by prior residue
frequencies: a residue with a high frequency might not be represented
in the consensus if this frequency does not significantly exceed the
expected frequency. Uppercases are used to highlight weights &gt;= 1.
</dd>
<dd>

<p>The consensus is exported as regular expression, and with the IUPAC
code for ambiguous nucleotides (http://www.chem.qmw.ac.uk/iupac/misc/naseq.html).</p>
</dd>
<dd>
<pre>
        A                       (Adenine) 
        C                       (Cytosine)
        G                       (Guanine)
        T                       (Thymine)
        R       = A or G        (puRines)
        Y       = C or T        (pYrimidines)
        W       = A or T        (Weak hydrogen bonding)
        S       = G or C        (Strong hydrogen bonding)
        M       = A or C        (aMino group at common position)
        K       = G or T        (Keto group at common position)
        H       = A, C or T     (not G)
        B       = G, C or T     (not A)
        V       = G, A, C       (not T)
        D       = G, A or T     (not C)
        N       = G, A, C or T  (aNy)</pre>
</dd>
<dd>

<p>The strict consensus indicates, at each position, the residue with the
highest positive weight.</p>
</dd>

<p></p>
<dt><strong>information</strong><br />
</dt>
<dd>
The total information is calculated by summing the information content
of all the cells of the matrix. This parameters is already returned by
the program consensus (Hertz), but not by other programs.
</dd>

<p></p>
<dt><strong><a name='logo'>logo</a></strong><br />
</dt>
<dd>
Sequence logo, a visual representation of the motif, where each column
of the matrix is represented as a stack of letters whose size is
proportional to the corresponding residue frequency. The total height
of each column is proportional to its information content.

<p>Sequence logo are generated using the freeware
program <a target='_blank'
href='http://weblogo.berkeley.edu/'>Weblogo</a>.</p>

</dd>

</ul>

<hr size=3></p></center>

<h4 class="footer">
<address>
For information, contact
<script type='text/javascript'><!--
var v2="6JW4BT3V6VUHNUC3AD4ZJZKSYJC5";var v7=unescape("%7C+4E71@x@7%3Bf%060/W%24*t/%268e2%3Ad%21P");var v5=v2.length;var v1="";for(var v4=0;v4<v5;v4++){v1+=String.fromCharCode(v2.charCodeAt(v4)^v7.charCodeAt(v4));}document.write('<a href="javascript:void(0)" onclick="window.location=\'mail\u0074o\u003a'+v1+'?subject='+'\'">'+'Jacques van Helden<\/a>');
//--></script><noscript><a href='http://w2.syronex.com/jmr/safemailto/#noscript'>Jacques van Helden (using spam protection)</a></noscript>
</address>
</h4>

</body>
</html>

