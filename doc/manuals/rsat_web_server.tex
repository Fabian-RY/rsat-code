\documentclass{article}
%\documentstyle[makeidx]{book}
\makeindex
\include{rsat_latex_commands}

\begin{document}

\title{Regulatory Sequence Analysis Tools \\
Web server installation}

\author{
	Jacques van Helden \\
	\email{jvanheld@scmbb.ulb.ac.be} \\
	\url{http://www.scmbb.ulb.ac.be/$\tilde{\hspace{0.4em}}$jvanheld/} \\
	\scmb 
}


\maketitle

\newpage
\tableofcontents
\newpage

\section{Description}

This documents describes the installation procedure for the web server
of the \textbf{Regulatory Sequence Analysis Tools} (\RSAT).

It assumes that you already installed the perl scripts and the
genomes, as described in the \RSAT installation guide.

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
% Web server

\section{Installing a local web server}

The Regulatory Sequence Analysis Tools include a web server, which
offers a user-friendly interface for biologists. The main server is
available for academic users at \url{http://rsat.ulb.ac.be/rsat/}. A
few additional mirrors have been installed in different countries.

\subsection{Web server pages}

The web pages are located in the directory
\file{rsa-tools/public\_html}. This directory contains both the HTML
pages, and the CGI scripts.

\subsection{Configuration of the Apache server}

In order to provide web access to the rsa-tools, you need to adapt the
configuration of your web server. This requires root privileges
(system administrator). 


The detailed settings depend on your web server program. We provide
here an example of typical settings for the Apache server (the most
widely used web server).

In summary, the configuration includes the following steps.

\begin{enumerate}
\item Open the apache configuration file \file{/etc/httpd/httpd.conf}

\item Specify an alias for rsa-tools in the appropriate section.

\begin{verbatim}
Alias /rsa-tools "/home/myaccount/rsa-tools/public_html/"
\end{verbatim}

\item Give authorization to execute CGI scripts in the rsa-tools directory

\begin{verbatim}
ScriptAlias /cgi-bin/ "/home/myaccount/rsa-tools/public_html/
\end{verbatim}

\item Specify the access options for the rsa-tools directory.

\begin{verbatim}
<Directory "/home/myaccount/rsa-tools/public_html">
   AllowOverride None
   Options ExecCGI Indexes
   Order allow,deny
   Allow from all
</Directory>
\end{verbatim}

\end{enumerate}

These are the basic steps to configure the web access to
\RSAT. Depending on your operating system, you probably need to
specify some additional settings. For example, on the Max OSX version
of Apache server allows to define a user-specific configuration in the
directory \file{/etc/httpd/users}.

Note that you need to restart the werb server for these changes to
take effect.

\subsection{Editing the configuration file for the server}

If you want to install a web server, you need to edit two variables on
the file \file{RSA.config}. Open this file with a text editor, and
specify the variables \texttt{\$config\_site} and \texttt{\$WWW\_RSA}
according to your local configuration.

\subsection{Cleaning the temporary directory}

The web server stores result ffiles in a temporary directory
\texttt{\$RSAT/public\_html/tmp}. These files remain 3 days on the
server, in order to allow users to consult their results.

The management of the temporary directory is performed using the
\program{crontab} command. For this, you need to add a command to your
personal \texttt{crontab} configuration file. 

\begin{enumerate}
\item Start to edit the crontab command file

\begin{verbatim}
crontab -e
\end{verbatim}

This will open your \file{crontab} file with your default text editor
(this default editor can be specified with the environment variable
EDITOR or VISUAL).

\item Add the following line to the \file{crontab} file. 

\begin{verbatim}
02 04 * * * make -f /home/myaccount/rsa-tools/makefiles/server.mk clean_tmp
\end{verbatim}

This will execute the make script \file{server.mk}, with the target
\texttt{clean\_tmp}, every day, at 04:02 AM. 

\item Save the modified crontab file and close your text editor.

\end{enumerate}

In principle, you will receive an email from \program{crontab} each
time the command is executed.


\subsection{testing the web server}

To test the werb server, open a web browser and connect the URL
\url{http://www.myserver/rsa-tools/} (you of course need to adapt the
 URL according to your IP address).

If you can obtain a connection, try to execute the demonstration of
the following pages.

\begin{description}
\item[\program{retrieve-seq}] to test the correct installation of genomes. 

\item[\program{oligo-analysis}] to test the correct installation of
background oligonucleotide frequencies.

\item[\program{feature-map}] to test the correct installation of the
graphical librairies.

\end{description}


\end{document}
