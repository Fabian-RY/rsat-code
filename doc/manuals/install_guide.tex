%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%
% Installation guide for regulatory Sequence Analysis Tools
%
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

\documentclass{book}
%\documentstyle[makeidx]{book}
\makeindex
\include{rsat_latex_commands}

\begin{document}

\title{Regulatory Sequence Analysis Tools \\
Installation guide}

\author{
	Jacques van Helden \\
	\email{jvhelden@ulb.ac.be} \\
	\url{http://www.bigre.ulb.ac.be/Users/jvanheld/} \\
	\bigre 
}


\maketitle

\newpage
\tableofcontents
\newpage

\chapter{Description and requirements}

\section{Description}

This documents describes the installation procedure for the software
package \textbf{Regulatory Sequence Analysis Tools} (\RSAT).

\section{Requirements}

\subsection{Operating system}

\RSAT is a unix-based package. It has been installed successfully on
the following operating systems.

\begin{enumerate}
\item Linux

\item Mac OSX

\item Sun Solaris

\item Dec Alpha

\item cygwin (under MS Windows 98) (except for the graphical
librairies, because I did not find a cygwin version of GD.pm)

\end{enumerate}

\RSAT is not compatible with any version of Microsoft Windows and I
have no intention to make it compatible in a foreseeable future. Since
most programs are written in perl, part of them might run under
windows, but some others will certainly not, because they include
calls to unix system commands.

\subsection{Perl language}

The programs in \RSAT are written in perl. Version 5.1 or
later is recommended.

\subsection{Perl modules}

Some perl modules are required for the graphical tools of \RSAT, and
for some other specific programs. The perl modules can be found in the
Comprehensive Perl Archive Network (\url{http://www.cpan.org/}), or
can be installed with the command \program{cpan}.

\begin{description}
\item[GD.pm] Interface to Gd Graphics Library. Used by
  \program{XYgraph} and \program{feature-map}.

\item[PostScript::Simple] Produce PostScript files from Perl. Used by
  \program{feature-map}.

\item[Math::CDF] Is used to calculate some probability distribution
  functions. In particular, it is used by the program
  \program{position-analysis} to calculate the P-value of the
  chi2. Note that this librairy is currently restricted to a precision
  of 1e-16. For the discrete functions (binomial , Poisson,
  hypergeometric) \RSAT relies on a custom library (
  \$RSAT/perl-scripts/lib/RSAT/stats.pm) which reaches a precision of
  1e-300.

\item[Util::Properties] This module is required to load property
  files, which are used to specify the site-specific configuration of
  your \RSAT server. Property filesa are also useful to write your own
  perl clients for the Web service interface to \RSAT (RSATWS).

\end{description}




%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
% Installation
\chapter{Obtaining \RSAT distribution}

For the time being, \RSAT is distributed as a compressed archive. In a
near future, we will also distribute it via an anonymous CVS server,
which will greatly facilitate the updates.

\textbf{Note} The CVS distribution will soon be available for external
users, but we still need to configure the CVS server to accept a guest
login. For the time being, the CVS distribution is still restricted to
the people from the lab. Inbetween, the only distribution mode for
external users is the compressed archive. If you are not member of the
BiGRe laboratory, please skip the section \textit{Installation from
  the CVS repository}.

\section{Installation from the CVS repository}


\subsection{CVS configuration}

You need to indicate your \program{cvs} client to use \program{ssh}
as remote shell application. For this, you can specify an environment
variable.

if your shell is tcsh, add the following line to the \file{.cshrc}
file in your home directory.

\begin{verbatim}
setenv CVS_RSH ssh
\end{verbatim}

If your shell is bash, add the following line to the \file{.bashrc}
file in your home directory.

\begin{verbatim}
export CVS_RSH=ssh
\end{verbatim}


\subsection{Obtaining a first version of \RSAT programs}

The following command should be used the first time you retrieve the
tools from the server (you need to replace \texttt{[mylogin]} by the
login name you received when signing the \RSAT license).

\begin{verbatim}
cvs -d [mylogin]@cvs.scmbb.ulb.ac.be:/cvs/rsat co rsa-tools
\end{verbatim}

This will create a directory \file{rsa-tools} on your computer, and
store the programs in it. Note that at this stage the programs are not
yet functional, because you still need to install genomes, which are
not included in the CVS distribution.

\subsection{Updating \RSAT programs}

Once the tools have been retrieved, you can obtain updates very
easily. For this, you need to change your directory to the rsa-tools
directory, and use the \texttt{cvs} command in the following way.

\begin{verbatim}
cd rsa-tools
cvs update -d
\end{verbatim}


\section{Installation from a compressed archive}

Uncompress the archive containing the programs. The archive is
distributed \texttt{tar} format.

The \texttt{.tar.gz} file can be uncompressed with the command
\program{tar}, which are part of the default unix installation.

\begin{verbatim}
tar -xpzf rsa-tools_yyyymmdd.tar.gz
\end{verbatim}

\section{Adding \RSAT to your path}

\begin{enumerate}

\item Create an environment variable named \textit{RSAT} and
  containing the path of rsa-tools.

  The way to create an environment variable depends on your shell. To
  know you shell, you can type

\begin{verbatim}
echo $SHELL
\end{verbatim}

Now, if we assume that \RSAT have been installed in the directory

\begin{verbatim}
/home/rsat/rsa-tools
\end{verbatim}

you should type the following command.

If your shell is bash:
\begin{verbatim}
export RSAT=/home/rsat/rsa-tools
\end{verbatim}

If your shell is csh or tcsh, you need to type a slightly different
command:

\begin{verbatim}
setenv RSAT /home/rsat/rsa-tools
\end{verbatim}

\item Add the path of the \RSAT perl scripts and binaries to your
  path.

If your shell is bash:
\begin{verbatim}
export PATH=${PATH}:${RSAT}/bin
export PATH=${PATH}:${RSAT}/perl-scripts
\end{verbatim}

If your shell is csh or tcsh:
\begin{verbatim}
set path=($path $RSAT/bin)
set path=($path $RSAT/perl-scripts)
rehash
\end{verbatim}

(the \texttt{rehash} command updates the list of executable programs)

\end{enumerate}

If you are using a different shell than bash, csh or tcsh, the
specification of environment variables might differ from the syntax
above.  In case of doubt, ask your system administrator how to
configure your environment variables and your path.

The specification of the environment variables and paths are required
each time you want to use \RSAT. You can add these specification to
your personal profile.  This file is normally found at the root of
your personal account, in the file \file{.bashrc} if your shell is
bash, or \file{.cshrc} if your shell is csh or tcsh. If you don't know
how to proceed, ask your system administrator.


%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
% Directories

\section{Initializing the directories}

In addition to the programs, the installation of rsa-tools requires
the creation of a few directories for storing data, access logs (for
the web server), and temporary files.  

The distribution includes a series of make scripts which will
facilitate this step. You just need go to the rsa-tools directory, and
start the appropriate make file.

\begin{verbatim}
cd rsa-tools
make -f makefiles/init_RSAT.mk init
\end{verbatim}


%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
% Config file
\section{Configuring \RSAT for utilization on the command line}

The \RSAT distribution comes with a template configuration file named
\file{RSAT\_config\_default.props} and located in the \file{rsa-tools}
directory.

Copy this file to create your own config file \file{RSAT\_config.props}.

\begin{verbatim}
cp RSAT_config_default.props RSAT_config.props 
\end{verbatim}

You need to edit this file and specify the parameters of your local
configuration. In particular, it is essential to specify the variable
RSAT, which specifies the RSAT main directory. 


%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
% Downloading genomes from RSAT main server

\input{ig_downloading_genomes.tex}



%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
% Tests for the command line tools
\chapter{Testing the command-line tools}

\section{Testing the access to perl scripts}

From now on, you should be able to use the perl scripts from the
command line. To test this, run: 

\begin{verbatim}
random-seq -help
\end{verbatim}

This should display the on-line help for the random sequence
generator. 

\begin{verbatim}
random-seq -l 200 -r 4 -a a:t 0.3 c:g 0.2
\end{verbatim}

Should generate a random sequence.

\section{Testing genome installation}

We will now test if the genomes are correctly installed. You can
obtain the list of supported organisms with the command:

\begin{verbatim}
supported-organisms
\end{verbatim}

If this command returns no result, it means that genomes were either
not installed, or not correctly configured. In such a case, check the
directories in the \file{data/genomes} directory, and check that the
file \file{data/supported\_organisms.pl}.

Once you can obtain the list of installed organisms, try to retrieve
some upstream sequences. You can first read the list of options for the
\program{retrieve-seq} program.

\begin{verbatim}
retrieve-seq -help
\end{verbatim}

Select an organism (say \org{Saccharomyces cerevisiae}), and
retrieve all the start codons with the following options :

\begin{verbatim}
retrieve-seq -org Saccharomyces_cerevisiae \
        -type upstream -from 0 -to +2 -all \
        -format wc -nocomment 
\end{verbatim}

This should return a set of 3 bp sequences, mostly ATG (in the case of
\org{Saccharomyces cerevisiae} at least)

\section{Testing the graphical scripts}

\RSAT includes two graphical tools, \program{feature-map} and
\program{XYgraph}. These tools require the following  perl modules: 

\begin{description}
\item[GD.pm] Interface to Gd Graphics Library.
\item[PostScript::Simple]  Produce PostScript files from Perl.
\end{description}

To test if these modules are available on your machine, type.

\begin{verbatim}
feature-map -help
\end{verbatim}

If the modules are available, you should see the help message of the
program feature-map. If not, you will see an error message complaining
about the missing librairies. In such a case, ask your system
administrator to install the missing modules.

\subsection{Installing third-party programs}

The \RSAT distribution only contains the programs developed by Jacques
van Helden. A few additional programs, developed by third parties, can
be integrated in the package. In order to obtain these programs,
please download them from their original site.

In particular, we recommend to install the following programs.

\begin{description}
\item[\program{vmatch}]: developed by Stefan Kurtz, is used used by the
program \program{purge-sequences}, for the detection of sequence repeats.

\item[\program{patser}]: developed by Jerry Hertz, is used for
  matrix-based pattern matching.

\item[matrix-based pattern discovery]: several other pattern discovery
  programs have been embedded in the \RSAT program
  \program{multiple-family-analysis}: 
\program{consensus} (Jerry Hertz),
\program{meme} (Tim Bailey),
\program{MotifSampler} (Gert Thijs),
\program{gibbs} (Andrew Neuwald).

\end{description}


\begin{table}
\begin{center}
\begin{tabular}{lll}
\hline
Program & author  & URL \\
\hline
vmatch & Stefan Kurtz & http://www.vmatch.de/ \\
patser & Jerry Hertz & ftp://ftp.genetics.wustl.edu/pub/stormo/Consensus/ \\
consensus & Jerry Hertz &  ftp://ftp.genetics.wustl.edu/pub/stormo/Consensus/ \\
meme & Tim Bailey & http://meme.sdsc.edu/meme/website/meme-download.html \\
MotifSampler & Gert Thijs & http://www.esat.kuleuven.ac.be/$\tilde{\hspace{0.4em}}$thijs/download.html \\
gibbs & Andrew Neuwald & ftp://ftp.ncbi.nih.gov/pub/neuwald/gibbs9\_95/ \\
\hline
\end{tabular}
\end{center}
\caption{\label{table:other_programs} Programs from other developers
  which are complementary to the \RSAT package.}
\end{table}

I particularly recommend the installation of \program{mkvtree} and
\program{vmatch} (Stefan Kurtz), because these programs are used by
the program purge-seq to discard redundant sequence fragments.

In order to add functionalities to \RSAT, install some or all of these
programs and include their binaries path rsa-tools/bin. If you are not
familiar with the installation of unix programs, ask assistance to
your system administrator.

\section{Further steps}

The installation is now finished, you can start the user's guide. 

In case you would like to install additional genomes that are not
supported on \RSAT main server, the next chapter indicates yiou how to
proceed.

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
% Parsing and installing additional genomes

\input{ug_installing_organisms.tex}

\end{document}

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

